<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.codehilite {background-color:#fff;color:#333333;}
.codehilite .hll {background-color:#ffffcc;}
.codehilite .c{color:#999988;font-style:italic}
.codehilite .err{color:#a61717;background-color:#e3d2d2}
.codehilite .k{font-weight:bold}
.codehilite .o{font-weight:bold}
.codehilite .cm{color:#999988;font-style:italic}
.codehilite .cp{color:#999999;font-weight:bold}
.codehilite .c1{color:#999988;font-style:italic}
.codehilite .cs{color:#999999;font-weight:bold;font-style:italic}
.codehilite .gd{color:#000000;background-color:#ffdddd}
.codehilite .ge{font-style:italic}
.codehilite .gr{color:#aa0000}
.codehilite .gh{color:#999999}
.codehilite .gi{color:#000000;background-color:#ddffdd}
.codehilite .go{color:#888888}
.codehilite .gp{color:#555555}
.codehilite .gs{font-weight:bold}
.codehilite .gu{color:#800080;font-weight:bold}
.codehilite .gt{color:#aa0000}
.codehilite .kc{font-weight:bold}
.codehilite .kd{font-weight:bold}
.codehilite .kn{font-weight:bold}
.codehilite .kp{font-weight:bold}
.codehilite .kr{font-weight:bold}
.codehilite .kt{color:#445588;font-weight:bold}
.codehilite .m{color:#009999}
.codehilite .s{color:#dd1144}
.codehilite .n{color:#333333}
.codehilite .na{color:teal}
.codehilite .nb{color:#0086b3}
.codehilite .nc{color:#445588;font-weight:bold}
.codehilite .no{color:teal}
.codehilite .ni{color:purple}
.codehilite .ne{color:#990000;font-weight:bold}
.codehilite .nf{color:#990000;font-weight:bold}
.codehilite .nn{color:#555555}
.codehilite .nt{color:navy}
.codehilite .nv{color:teal}
.codehilite .ow{font-weight:bold}
.codehilite .w{color:#bbbbbb}
.codehilite .mf{color:#009999}
.codehilite .mh{color:#009999}
.codehilite .mi{color:#009999}
.codehilite .mo{color:#009999}
.codehilite .sb{color:#dd1144}
.codehilite .sc{color:#dd1144}
.codehilite .sd{color:#dd1144}
.codehilite .s2{color:#dd1144}
.codehilite .se{color:#dd1144}
.codehilite .sh{color:#dd1144}
.codehilite .si{color:#dd1144}
.codehilite .sx{color:#dd1144}
.codehilite .sr{color:#009926}
.codehilite .s1{color:#dd1144}
.codehilite .ss{color:#990073}
.codehilite .bp{color:#999999}
.codehilite .vc{color:teal}
.codehilite .vg{color:teal}
.codehilite .vi{color:teal}
.codehilite .il{color:#009999}
.codehilite .gc{color:#999;background-color:#EAF2F5}
</style><title>Project_2_Pig</title></head><body><article class="markdown-body"><h1 id="project-2-apache-pig">Project 2: Apache Pig<a class="headerlink" href="#project-2-apache-pig" title="Permanent link"></a></h1>
<ol>
<li>Output the ​birth city​ of the player who had the most runs batted in (RBI) in his career.</li>
</ol>
<div class="codehilite"><pre>batters_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Batting.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
master_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Master.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
player_table <span class="o">=</span> <span class="k">FOREACH</span> batters_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $11 <span class="k">AS</span> rbi;
master_table <span class="o">=</span> <span class="k">FOREACH</span> master_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $6 <span class="k">AS</span> birthcity;
joined_data <span class="o">=</span> <span class="k">JOIN</span> player_table <span class="k">BY</span> id, master_table <span class="k">BY</span> id;
joined_data2 <span class="o">=</span> <span class="k">FOREACH</span> joined_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $3 <span class="k">AS</span> birthcity, $1 <span class="k">AS</span> rbi;
filtered_joined_data <span class="o">=</span> <span class="k">FILTER</span> joined_data2 <span class="k">BY</span> rbi <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
joined_grouped <span class="o">=</span> <span class="k">GROUP</span> filtered_joined_data <span class="k">BY</span> id;
player_sum_rbi <span class="o">=</span>
    <span class="k">FOREACH</span> joined_grouped <span class="p">{</span>
        b <span class="o">=</span> filtered_joined_data.birthcity;
        s <span class="o">=</span> <span class="k">DISTINCT</span> b;
        <span class="k">GENERATE</span> <span class="k">group</span><span class="o">,</span> <span class="k">FLATTEN</span><span class="p">(</span>s<span class="p">)</span><span class="o">,</span> <span class="nb">SUM</span><span class="p">(</span>filtered_joined_data.rbi<span class="p">)</span> <span class="k">AS</span> sum_rbi;
    <span class="p">};</span>
max_rbi_grouped <span class="o">=</span> <span class="k">GROUP</span> player_sum_rbi <span class="k">ALL</span><span class="p">;</span>
total_max_rbi <span class="o">=</span> <span class="k">FOREACH</span> max_rbi_grouped <span class="k">GENERATE</span> <span class="nb">MAX</span><span class="p">(</span>player_sum_rbi.sum_rbi<span class="p">)</span> <span class="k">AS</span> max_rbi_hits;
filter_player <span class="o">=</span> <span class="k">FILTER</span> player_sum_rbi <span class="k">BY</span> sum_rbi <span class="o">==</span> total_max_rbi.max_rbi_hits;
birth_city <span class="o">=</span> <span class="k">FOREACH</span> filter_player <span class="k">GENERATE</span> birthcity;
limit_data <span class="o">=</span> <span class="k">LIMIT</span> birth_city <span class="mi">4</span><span class="p">;</span>
<span class="k">DUMP</span> limit_data;
</pre></div>

<ol>
<li>Output the​ top three birthMonth/birthYear t​hat had the most players born. I am only looking for month and year combinations. For instance, how many were born in February, 1956, how many were born in March, 1975, and so on. Print out the top three ​mm/yyyy​ combinations. You must report the information in mm/yyyy form (i.e. it is ok to print out 5 instead of 05).</li>
</ol>
<div class="codehilite"><pre>master_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Master.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
master_table <span class="o">=</span> <span class="k">FOREACH</span> master_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $1 <span class="k">AS</span> birthyear, $2 <span class="k">AS</span> birthmonth, <span class="nb">CONCAT</span><span class="p">(</span>$2,<span class="s">&#39;/&#39;</span><span class="o">,</span>$1<span class="p">)</span> <span class="k">AS</span> month_year;
master_table <span class="o">=</span> <span class="k">FILTER</span> master_table <span class="k">BY</span> $1 <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> $2 <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
grouped_data <span class="o">=</span> <span class="k">GROUP</span> master_table <span class="k">BY</span> month_year;
count_births <span class="o">=</span> <span class="k">FOREACH</span> grouped_data <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> month_year, <span class="nb">COUNT</span><span class="p">(</span>master_table.id<span class="p">)</span> <span class="k">AS</span> count_births;
grouped_births <span class="o">=</span> <span class="k">GROUP</span> count_births <span class="k">BY</span> count_births;
grouped_births_fields <span class="o">=</span> <span class="k">FOREACH</span> grouped_births <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> count_births, count_births.month_year <span class="k">AS</span> month_year;
order_births <span class="o">=</span> <span class="k">ORDER</span> grouped_births_fields <span class="k">BY</span> count_births <span class="k">DESC</span><span class="p">;</span>
top_3 <span class="o">=</span> <span class="k">LIMIT</span> order_births <span class="mi">3</span><span class="p">;</span>
result <span class="o">=</span> <span class="k">FOREACH</span> top_3 <span class="k">GENERATE</span> month_year;
<span class="k">DUMP</span> result;
</pre></div>

<ol>
<li>There are 2 people that had unique heights. Who are they? You should output their first and last names.</li>
</ol>
<div class="codehilite"><pre>master_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Master.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
master_table <span class="o">=</span> <span class="k">FOREACH</span> master_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $17 <span class="k">AS</span> height, <span class="nb">CONCAT</span><span class="p">(</span>$13,<span class="s">&#39; &#39;</span><span class="o">,</span>$14<span class="p">)</span> <span class="k">AS</span> name;
master_table <span class="o">=</span> <span class="k">FILTER</span> master_table <span class="k">BY</span> height <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
grouped_heights <span class="o">=</span> <span class="k">GROUP</span> master_table <span class="k">BY</span> height;
count_table <span class="o">=</span> <span class="k">FOREACH</span> grouped_heights <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> height, master_table.name <span class="k">AS</span> name, <span class="nb">COUNT</span><span class="p">(</span>master_table.id<span class="p">)</span> <span class="k">AS</span> num_heights;
filtered_table <span class="o">=</span> <span class="k">FILTER</span> count_table <span class="k">BY</span> num_heights <span class="o">==</span> <span class="mi">1</span> <span class="k">AND</span> height <span class="o">!=</span> <span class="s">&#39;height&#39;</span><span class="p">;</span>
result <span class="o">=</span> <span class="k">FOREACH</span> filtered_table <span class="k">GENERATE</span> name;
<span class="k">DUMP</span> result;
</pre></div>

<ol>
<li>Which ​team​, after 1950, had the most errors in any 1 season. A season is denoted by the year.</li>
</ol>
<div class="codehilite"><pre>fielding_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Fielding.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
fielding_table <span class="o">=</span> <span class="k">FOREACH</span> fielding_data <span class="k">GENERATE</span> $1 <span class="k">AS</span> year, $2 <span class="k">AS</span> team, $10 <span class="k">AS</span> errors;
fielding_table <span class="o">=</span> <span class="k">FILTER</span> fielding_table <span class="k">BY</span> year <span class="o">&gt;</span> <span class="mi">1950</span> <span class="k">AND</span> errors <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
ft_group <span class="o">=</span> <span class="k">GROUP</span> fielding_table <span class="k">BY</span> <span class="p">(</span>team, year<span class="p">);</span>
team_sum_errors <span class="o">=</span> <span class="k">FOREACH</span> ft_group <span class="k">GENERATE</span> <span class="k">group</span><span class="o">,</span> <span class="nb">SUM</span><span class="p">(</span>fielding_table.errors<span class="p">)</span> <span class="k">AS</span> sum_errors;
team_sum_errors_group <span class="o">=</span> <span class="k">GROUP</span> team_sum_errors <span class="k">ALL</span><span class="p">;</span>
team_max_errors <span class="o">=</span> <span class="k">FOREACH</span> team_sum_errors_group <span class="k">GENERATE</span> <span class="nb">MAX</span><span class="p">(</span>team_sum_errors.sum_errors<span class="p">)</span> <span class="k">AS</span> max_errors;
max_errors_filtered <span class="o">=</span> <span class="k">FILTER</span> team_sum_errors <span class="k">BY</span> sum_errors <span class="o">==</span> team_max_errors.max_errors;
result <span class="o">=</span> <span class="k">FOREACH</span> max_errors_filtered <span class="k">GENERATE</span> <span class="k">group</span><span class="o">.</span>team;
<span class="k">DUMP</span> result;
</pre></div>

<ol>
<li>Output the ​playerID​ and ​team​ of the player who had the most errors with any 1 team in all seasons combined. Only consider seasons after 1950.</li>
</ol>
<div class="codehilite"><pre>fielding_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Fielding.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
fielding_table <span class="o">=</span> <span class="k">FOREACH</span> fielding_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $1 <span class="k">AS</span> year, $2 <span class="k">AS</span> team, $10 <span class="k">AS</span> errors;
fielding_table <span class="o">=</span> <span class="k">FILTER</span> fielding_table <span class="k">BY</span> year <span class="o">&gt;</span> <span class="mi">1950</span> <span class="k">AND</span> errors <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
ft_group <span class="o">=</span> <span class="k">GROUP</span> fielding_table <span class="k">BY</span> <span class="p">(</span>id, team<span class="p">);</span>
sum_player_errors <span class="o">=</span> <span class="k">FOREACH</span> ft_group <span class="k">GENERATE</span> <span class="k">group</span><span class="o">,</span> <span class="nb">SUM</span><span class="p">(</span>fielding_table.errors<span class="p">)</span> <span class="k">AS</span> sum_errors;
ordered <span class="o">=</span> <span class="k">ORDER</span> sum_player_errors <span class="k">BY</span> sum_errors <span class="k">DESC</span><span class="p">;</span>
top_1 <span class="o">=</span> <span class="k">LIMIT</span> ordered <span class="mi">1</span><span class="p">;</span>
result <span class="o">=</span> <span class="k">FOREACH</span> top_1 <span class="k">GENERATE</span> <span class="k">group</span><span class="p">;</span>
<span class="k">DUMP</span> result;
</pre></div>

<ol>
<li>
<p>A player who hits well and doesn’t commit a lot of errors is obviously a player you want on your team. Output the ​playerID’s​ of the top 3 players from 2005 through 2009 (including 2005 and 2009) who maximized the following criterion:</p>
<p>(number of hits (H) / number of at bats (AB)) – (number of errors (E) / number of games (G))</p>
<p>The above equation might be skewed by a player who only had 3 at bats but got two hits. To account for that, only consider players who had at least 40 at bats and played in at least 20 games ​over that entire 5 year span​. You should note that both files contain a “number of games” column. ​The 20 game minimum and the games values that you are using must come from the Fielding.csv file. For this problem, be sure to ignore rows in the Fielding.csv file that are in the file for ​informational p​ urposes only. An ​informational r​ ow contains no data in the 7th-17th columns (start counting at column 1). In other words, if all of the 7th, 8th, 9th, &hellip; 16th and 17th columns are empty, the row is informational and should be ignored.</p>
</li>
</ol>
<div class="codehilite"><pre>batters_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Batting.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
fielding_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Fielding.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
fielding_table <span class="o">=</span> <span class="k">FOREACH</span> fielding_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $1 <span class="k">AS</span> year, $5 <span class="k">AS</span> G, $10 <span class="k">AS</span> error, $7 <span class="k">AS</span> a, $8 <span class="k">AS</span> b, $9 <span class="k">AS</span> c, $10 <span class="k">AS</span> d, $11AS e, $12AS f, $13AS g, $14AS h, $15 <span class="k">AS</span> i, $16 <span class="k">AS</span> j, $17 <span class="k">AS</span> k;
fielding_table <span class="o">=</span> <span class="k">FILTER</span> fielding_table <span class="k">BY</span> <span class="p">(</span>year <span class="o">&gt;=</span> <span class="mi">2005</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span>year <span class="o">&lt;=</span> <span class="mi">2009</span><span class="p">)</span> <span class="k">AND</span> G <span class="o">&gt;=</span> <span class="mi">20</span> <span class="k">AND</span> <span class="k">NOT</span> <span class="p">(</span>a <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> b <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> c <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> d <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> e <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> f <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> g <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> h <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> i <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> j <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> k <span class="k">IS</span> <span class="k">NULL</span><span class="p">);</span>
batting_table <span class="o">=</span> <span class="k">FOREACH</span> batters_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $1 <span class="k">AS</span> year, $5 <span class="k">AS</span> AB, $7 <span class="k">AS</span> H;
batting_table <span class="o">=</span> <span class="k">FILTER</span> batting_table <span class="k">BY</span> <span class="p">(</span>year <span class="o">&gt;=</span> <span class="mi">2005</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span>year <span class="o">&lt;=</span> <span class="mi">2009</span><span class="p">)</span> <span class="k">AND</span> AB <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">;</span>
joined_data <span class="o">=</span> <span class="k">JOIN</span> fielding_table <span class="k">BY</span> id, batting_table <span class="k">BY</span> id;
full_table <span class="o">=</span> <span class="k">FOREACH</span> joined_data <span class="k">GENERATE</span> fielding_table::id <span class="k">AS</span> id, fielding_table::year <span class="k">AS</span> year, H <span class="k">AS</span> H, AB <span class="k">AS</span> AB, error <span class="k">AS</span> error, G <span class="k">AS</span> G;
grouped_table <span class="o">=</span> <span class="k">GROUP</span> full_table <span class="k">BY</span> id;
joined_table <span class="o">=</span> <span class="k">FOREACH</span> grouped_table <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> id, full_table.year <span class="k">AS</span> year, <span class="p">(</span><span class="nb">SUM</span><span class="p">(</span>full_table.H<span class="p">)</span><span class="o">/</span><span class="nb">SUM</span><span class="p">(</span>full_table.AB<span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span>full_table.error<span class="p">)</span><span class="o">/</span><span class="nb">SUM</span><span class="p">(</span>full_table.G<span class="p">))</span> <span class="k">AS</span> calc;
ordered_table <span class="o">=</span> <span class="k">ORDER</span> joined_table <span class="k">BY</span> calc <span class="k">DESC</span><span class="p">;</span> 
top_3 <span class="o">=</span> <span class="k">LIMIT</span> ordered_table <span class="mi">3</span><span class="p">;</span>
result <span class="o">=</span> <span class="k">FOREACH</span> top_3 <span class="k">GENERATE</span> id;
<span class="k">DUMP</span> result;
</pre></div>

<ol>
<li>Sum up the number of doubles and triples for each birthCity/birthState combination. Output the ​top 5 birthCity/birthState ​combinations that produced the players who had the most doubles and triples combined (i.e., combine the doubles and triples for all players with that city/state combination). Some caveats:
* A ​birthState​ is any non-empty value in the birthState column.
* The ​birthCity m​ ust start with a vowel (i.e an A, E, I, O or U).</li>
</ol>
<div class="codehilite"><pre>batters_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Batting.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
master_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Master.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
masters_table <span class="o">=</span> <span class="k">FOREACH</span> master_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $5 <span class="k">AS</span> birthstate, $6  <span class="k">AS</span> birthcity;
masters_table <span class="o">=</span> <span class="k">FILTER</span> masters_table <span class="k">BY</span> birthstate <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> birthcity <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="p">(</span><span class="nf">STARTSWITH</span><span class="p">(</span>birthcity, <span class="s">&#39;A&#39;</span><span class="p">)</span> <span class="k">OR</span> <span class="nf">STARTSWITH</span><span class="p">(</span>birthcity, <span class="s">&#39;E&#39;</span><span class="p">)</span> <span class="k">OR</span> <span class="nf">STARTSWITH</span><span class="p">(</span>birthcity, <span class="s">&#39;I&#39;</span><span class="p">)</span> <span class="k">OR</span> <span class="nf">STARTSWITH</span><span class="p">(</span>birthcity, <span class="s">&#39;O&#39;</span><span class="p">)</span> <span class="k">OR</span> <span class="nf">STARTSWITH</span><span class="p">(</span>birthcity, <span class="s">&#39;U&#39;</span><span class="p">));</span>
batters_table <span class="o">=</span> <span class="k">FOREACH</span> batters_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, <span class="p">(</span><span class="kt">int</span><span class="p">)</span>$8 <span class="k">AS</span> two, <span class="p">(</span><span class="kt">int</span><span class="p">)</span>$9 <span class="k">AS</span> three;
batters_table <span class="o">=</span> <span class="k">FILTER</span> batters_table <span class="k">BY</span> two <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> three <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
joined_tables <span class="o">=</span> <span class="k">JOIN</span> masters_table <span class="k">BY</span> id, batters_table <span class="k">BY</span> id;
joined_tables_exp <span class="o">=</span> <span class="k">FOREACH</span> joined_tables <span class="k">GENERATE</span> birthcity, birthstate, two, three;
grouped_tables <span class="o">=</span> <span class="k">GROUP</span> joined_tables_exp <span class="k">BY</span> <span class="p">(</span>birthcity, birthstate<span class="p">);</span>
summary <span class="o">=</span> <span class="k">FOREACH</span> grouped_tables <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> city_state, <span class="nb">SUM</span><span class="p">(</span>joined_tables_exp.two<span class="p">)</span><span class="o">+</span><span class="nb">SUM</span><span class="p">(</span>joined_tables_exp.three<span class="p">)</span> <span class="k">AS</span> sum_hits;
order_summary <span class="o">=</span> <span class="k">ORDER</span> summary <span class="k">BY</span> sum_hits <span class="k">DESC</span><span class="p">;</span>
top_5 <span class="o">=</span> <span class="k">LIMIT</span> order_summary <span class="mi">5</span><span class="p">;</span>
city_state_summary <span class="o">=</span> <span class="k">FOREACH</span> top_5 <span class="k">GENERATE</span> city_state;
<span class="k">DUMP</span> city_state_summary;
</pre></div>

<ol>
<li>Output the ​birthMonth/birthState​ combination that produced the worst players.</li>
</ol>
<p>The worst players are defined by the lowest of: (number of hits (H) / number of at bats (AB)) To ensure a small number of people who hardly played don’t skew the data, make sure that:</p>
<ul>
<li>at least 10 people came from the same state and were born in the same month and</li>
<li>
<p>the sum of the at-bats for all of the players from the same birthMonth/birthState​ ​exceeds 1500. </p>
<p>For this problem, the year does not matter. A player born in December, 1970 in Michigan and a player born in December, 1982 in Michigan are in the same group because they were both born in December and were born in Michigan. A birthState​ is any non-empty value in the birthState column. In terms of condition a., you should count a player as one of your 10 players even if the player has no at-bats and/or no hits. You should ignore all players who do not have a birthMonth or who do not have a birthState.</p>
</li>
</ul>
<div class="codehilite"><pre>batters_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Batting.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
master_data <span class="o">=</span> <span class="k">LOAD</span> <span class="s">&#39;hdfs:/user/maria_dev/pigtest/Master.csv&#39;</span> <span class="k">using</span> <span class="nb">PigStorage</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">);</span>
batters_table <span class="o">=</span> <span class="k">FOREACH</span> batters_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, <span class="p">(</span><span class="kt">int</span><span class="p">)</span>$5 <span class="k">AS</span> AB, <span class="p">(</span><span class="kt">int</span><span class="p">)</span>$7 <span class="k">AS</span> H;
batters_table <span class="o">=</span> <span class="k">FILTER</span> batters_table <span class="k">BY</span> AB <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> H <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
masters_table <span class="o">=</span> <span class="k">FOREACH</span> master_data <span class="k">GENERATE</span> $0 <span class="k">AS</span> id, $5 <span class="k">AS</span> birthstate, $2  <span class="k">AS</span> birthmonth;
masters_table <span class="o">=</span> <span class="k">FILTER</span> masters_table <span class="k">BY</span> birthstate <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> birthmonth <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
joined_tables <span class="o">=</span> <span class="k">JOIN</span> masters_table <span class="k">BY</span> id, batters_table <span class="k">BY</span> id;
joined_tables_exp <span class="o">=</span> <span class="k">FOREACH</span> joined_tables <span class="k">GENERATE</span> batters_table::id <span class="k">AS</span> id, birthmonth, birthstate, AB, H <span class="k">AS</span> H;
grouped_tables <span class="o">=</span> <span class="k">GROUP</span> joined_tables_exp <span class="k">BY</span> <span class="p">(</span>birthmonth, birthstate<span class="p">);</span>
summary <span class="o">=</span> <span class="k">FOREACH</span> grouped_tables <span class="p">{</span>
        AB <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span>joined_tables_exp.AB<span class="p">);</span>
        H <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span>joined_tables_exp.H<span class="p">);</span>
        id <span class="o">=</span> joined_tables_exp.id;
        distinct_id <span class="o">=</span> <span class="k">DISTINCT</span> id;
        <span class="k">GENERATE</span> <span class="k">group</span> <span class="k">AS</span> month_state, <span class="nb">COUNT</span><span class="p">(</span>distinct_id<span class="p">)</span> <span class="k">AS</span> <span class="nb">count</span><span class="o">,</span> AB <span class="k">AS</span> AB, H <span class="k">AS</span> H, <span class="p">(</span><span class="kt">float</span><span class="p">)</span>H/<span class="p">(</span><span class="kt">float</span><span class="p">)</span>AB <span class="k">AS</span> calc;
    <span class="p">};</span>
filtered <span class="o">=</span> <span class="k">FILTER</span> summary <span class="k">BY</span> <span class="nb">count</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">AND</span> AB <span class="o">&gt;</span> <span class="mi">1500</span><span class="p">;</span>
ordered <span class="o">=</span> <span class="k">ORDER</span> filtered <span class="k">BY</span> calc <span class="k">ASC</span><span class="p">;</span>
output_combo <span class="o">=</span> <span class="k">FOREACH</span> ordered <span class="k">GENERATE</span> month_state;
top_1 <span class="o">=</span> <span class="k">LIMIT</span> output_combo <span class="mi">1</span><span class="p">;</span>
<span class="k">DUMP</span> top_1;
</pre></div></article></body></html>